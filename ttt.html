<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>Can you beat me?</title>
		<meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'>
        <!-- bootstrap css -->
        <link href="http://localhost/ezgame/bootflat/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
        <!-- bootflat css -->
        <link href="http://localhost/ezgame/bootflat/css/bootflat.min.css" rel="stylesheet" type="text/css"/>
        <!-- fontawesome css -->
        <link href="http://localhost/ezgame/bootflat/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>

        <style type="text/css">
        	body
        	{
        		background-image: url(./assets/img/schematics2013.png);
        		background-repeat: repeat;
        	}
        </style>

		<script src="http://localhost/ezgame/bootflat/js/jquery.min.js" type="text/javascript"></script>
		<script src="http://localhost/ezgame/bootflat/js/jquery-1.10.1.min.js" type="text/javascript"></script>
		<script src="http://localhost/ezgame/bootflat/js/bootstrap.min.js" type="text/javascript"></script>
	</head>
	<body>
		<div class="container">
			<div class="row" style="margin-top: 15px;">
				<div class="col-md-1">
					<center>
						<button class="btn btn-block btn-success number" value="1" id="number-1">
							<h5>1</h5>
						</button>		
					</center>
				</div>
				<div class="col-md-1">
					<center>
						<button class="btn btn-block btn-success number" value="2" id="number-2">
							<h5>2</h5>
						</button>		
					</center>
				</div>
				<div class="col-md-1">
					<center>
						<button class="btn btn-block btn-success number" value="3" id="number-3">
							<h5>3</h5>
						</button>		
					</center>
				</div>
				<div class="col-md-1">
					<center>
						<button class="btn btn-block btn-success number" value="4" id="number-4">
							<h5>4</h5>
						</button>		
					</center>
				</div>
				<div class="col-md-1">
					<center>
						<button class="btn btn-block btn-success number" value="5" id="number-5">
							<h5>5</h5>
						</button>		
					</center>
				</div>
				<div class="col-md-1">
					<center>
						<button class="btn btn-block btn-success number" value="6" id="number-6">
							<h5>6</h5>
						</button>		
					</center>
				</div>
				<div class="col-md-1">
					<center>
						<button class="btn btn-block btn-success number" value="7" id="number-7">
							<h5>7</h5>
						</button>		
					</center>
				</div>
				<div class="col-md-1">
					<center>
						<button class="btn btn-block btn-success number" value="8" id="number-8">
							<h5>8</h5>
						</button>		
					</center>
				</div>
				<div class="col-md-1">
					<center>
						<button class="btn btn-block btn-success number" value="9" id="number-9">
							<h5>9</h5>
						</button>		
					</center>
				</div>
			</div>
			<div class="row" style="margin-top: 50px;">
				<div class="col-md-12">
					<!-- <div class="alert alert-success"> -->
						<div class="row">
							<div class="col-md-2">
								<div class="alert" style="background-color: #22A7F0" id="player-name">
									You
								</div>
							</div>
							<div class="col-md-2">
								<div class="alert hidden" style="background-color: #264348; color: white"  id="player-choice-1">
									
								</div>
							</div>
							<div class="col-md-2">
								<div class="alert hidden" style="background-color: #264348; color: white"  id="player-choice-2">
									
								</div>
							</div>
							<div class="col-md-2">
								<div class="alert hidden" style="background-color: #264348; color: white"  id="player-choice-3">
									
								</div>
							</div>
							<div class="col-md-2">
								<div class="alert hidden" style="background-color: #264348; color: white"  id="player-choice-4">
									
								</div>
							</div>
							<div class="col-md-2">
								<div class="alert hidden" style="background-color: #264348; color: white"  id="player-choice-5">
									
								</div>
							</div>
						</div>
					<!-- </div> -->
				</div>
			</div>
			<div class="row" style="margin-top: 20px;">
				<div class="col-md-12" id="computer">
					<!-- <div class="alert alert-danger"> -->
						<div class="row">
							<div class="col-md-2">
								<div class="alert" style="background-color: #26A65B" id="computer-name">
									You
								</div>
							</div>
							<div class="col-md-2">
								<div class="alert hidden" style="background-color: #006442; color: white" id="computer-choice-1">
									
								</div>
							</div>
							<div class="col-md-2">
								<div class="alert hidden" style="background-color: #006442; color: white" id="computer-choice-2">
									
								</div>
							</div>
							<div class="col-md-2">
								<div class="alert hidden" style="background-color: #006442; color: white" id="computer-choice-3">
									
								</div>
							</div>
							<div class="col-md-2">
								<div class="alert hidden" style="background-color: #006442; color: white" id="computer-choice-4">
									
								</div>
							</div>
							<div class="col-md-2">
								<div class="alert hidden" style="background-color: #006442; color: white" id="computer-choice-5">
									
								</div>
							</div>
						</div>
					<!-- </div> -->
				</div>
			</div>
			<div class="row">
				<div class="col-md-1" id="t-1"></div>
				<div class="col-md-1" id="t-2"></div>
				<div class="col-md-1" id="t-3"></div>
			</div>
			<div class="row">
				<div class="col-md-1" id="t-4"></div>
				<div class="col-md-1" id="t-5"></div>
				<div class="col-md-1" id="t-6"></div>
			</div>
			<div class="row">
				<div class="col-md-1" id="t-7"></div>
				<div class="col-md-1" id="t-8"></div>
				<div class="col-md-1" id="t-9"></div>
			</div>
		</div>

		<script type="text/javascript">
			$(document).ready(function(){
				// player is coded as 0
				// computer is coded as 1
				var grid = {
					0:0,
					1:2,
					2:7,
					3:6,
					4:9,
					5:5,
					6:1,
					7:4,
					8:3,
					9:8
				};
				var reverseGrid = {
					0:0,
					2:1,
					7:2,
					6:3,
					9:4,
					5:5,
					1:6,
					4:7,
					3:8,
					8:9
				};
				var gridChecked = [
				[1,2,3],
				[4,5,6],
				[7,8,9],
				[1,4,7],
				[2,5,8],
				[3,6,9],
				[1,5,9],
				[3,5,7]
				];
				var wiseNumber = [5,1,3,7,9,2,4,6,8];
				var combination = [[0,1,2],[0,2,1],[1,2,0]];
				var filler = [-1,-1,-1,-1,-1,-1,-1,-1,-1,-1];
				var magicNumber = [-1,-1,-1];
				var playerMoveCount = 1;
				var computerMoveCount = 1;
				var lastFiller = -1;
				var winner = -1;

				$('.number').click(function(){
					filler[reverseGrid[this.value]] = 0;
					lastFiller = 0;					
					$('#player-choice-' + playerMoveCount).removeClass('hidden');
					$('#player-choice-' + playerMoveCount).html(this.value);
					playerMoveCount++;

					disableNumber(this);
					playerPlay();
				});

				function disableNumber(number)
				{
					$(number).removeClass('btn-success');
					$(number).addClass('btn-danger');
					$(number).addClass('disabled');
				}

				function playerPlay()
				{
					if(isWin())
					{
						congratulation();
						return;
					}
					else if(isDraw())
					{
						draw();
						return;
					}
					else
					{
						computerPlay();
					}
					return;
				}

				function computerPlay()
				{
					lastFiller = 1;
					if(!preventDefeated())
					{
						if(!winningMove())
						{
							chooseWiseNumber();
						}
					}
					if(isWin())
					{

					}
					else if(isDraw())
					{

					}
					// showTable();
					return;
				}

				function showTable()
				{
					for(var i=1; i<=9; i++)
					{
						$('#t-'+i).html(filler[i]);
					}
				}

				function winningMove()
				{
					for(var i=0; i<8; i++)
					{
						for(var j=0; j<3; j++)
						{
							if(filler[gridChecked[i][combination[j][0]]]==lastFiller && filler[gridChecked[i][combination[j][1]]]==lastFiller && filler[gridChecked[i][combination[j][2]]]==-1)
							{
								filler[gridChecked[i][combination[j][2]]] = lastFiller;
								var number = grid[gridChecked[i][combination[j][2]]];
								$('#computer-choice-' + computerMoveCount).removeClass('hidden');
								$('#computer-choice-' + computerMoveCount).html(number);
								computerMoveCount++;

								disableNumber('#number-' + number);
								return true;
							}
						}
					}
					return false;
				}

				function chooseWiseNumber()
				{
					for(var i=0; i<9; i++)
					{
						if(filler[wiseNumber[i]] == -1)
						{
							filler[wiseNumber[i]] = lastFiller;
							var number = grid[wiseNumber[i]];
							$('#computer-choice-' + computerMoveCount).removeClass('hidden');
							$('#computer-choice-' + computerMoveCount).html(number);
							computerMoveCount++;

							disableNumber('#number-' + number);
							return true;
						}
					}
				}

				function preventDefeated()
				{
					for(var i=0; i<8; i++)
					{
						for(var j=0; j<3; j++)
						{
							if(filler[gridChecked[i][combination[j][0]]]==0 && filler[gridChecked[i][combination[j][1]]]==0 && filler[gridChecked[i][combination[j][2]]]==-1)
							{
								filler[gridChecked[i][combination[j][2]]] = lastFiller;
								var number = grid[gridChecked[i][combination[j][2]]];
								$('#computer-choice-' + computerMoveCount).removeClass('hidden');
								$('#computer-choice-' + computerMoveCount).html(number);
								computerMoveCount++;

								disableNumber('#number-' + number);
								return true;
							}
						}
					}
					return false;
				}

				function isDraw()
				{
					if(playerMoveCount+computerMoveCount >= 9)
					{
						return true;
					}
					return false;
				}

				function isWin()
				{
					// check all winning conditions
					for(var i=0; i<8; i++)
					{
						var found = true;
						var j;
						for(j=0; j<3; j++)
						{
							if(filler[gridChecked[i][j]] != lastFiller)
							{
								found = false;
								break;
							}
						}
						if(found)
						{
							winner = lastFiller;
							magicNumber = [grid[gridChecked[i][0]],grid[gridChecked[i][1]],grid[gridChecked[i][2]]];
							return true;
						}
					}
					return false;
				}

				function congratulation()
				{
					alert('win');
				}

				function draw()
				{
					alert('draw');
				}
			});
		</script>
	</body>
</html>